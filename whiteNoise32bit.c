//const uint8_t lookup[] = {0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0};
const uint8_t lookup[] = {0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0};
const uint8_t update[] = {4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,2,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,16,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,2,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,1,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,2,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,16,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,2,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,32,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,2,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,16,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,2,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,1,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,2,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,16,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,2,4,128,4,8,4,128,4,64,4,128,4,8,4,128,4,32};
uint32_t lfsr;
uint8_t top;
uint8_t bot;


void setup(){
    lfsr = random(1,255);
    DDRD = 0xFF;
    pinMode(8, OUTPUT);
}


void loop(){
    //72 cycles
    memcpy((void*)&top, (void*)&lfsr+3, 1);
    memcpy((void*)&bot, (void*)&lfsr+1, 1);
    lfsr <<= 1;
    lfsr += lookup[(top&0xC0) | (bot&0x03)];
    PORTD ^= (lfsr & update[PORTB]);
    PORTB++;
    //c++;

    // Replace PORTB with a uint8_t var; just for testing

}